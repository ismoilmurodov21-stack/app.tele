<!DOCTYPE html>
<html lang="tj">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IT-Professional Shop FF</title>
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --accent: #22c55e;
            --text: #ffffff;
            --gray: #94a3b8;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: -apple-system, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        header { padding: 15px; text-align: center; border-bottom: 1px solid var(--card); }
        
        /* Banner / –†–µ–∫–ª–∞–º–∞ */
        #banner-box { padding: 10px; display: none; }
        .banner {
            width: 100%; height: 140px; border-radius: 15px;
            background-size: cover; background-position: center;
            display: flex; align-items: flex-end; overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        .banner-text {
            background: rgba(0,0,0,0.6); width: 100%; padding: 8px;
            font-size: 13px; backdrop-filter: blur(5px);
        }

        /* Products Grid (2 Rows) */
        .products {
            display: grid; grid-template-columns: repeat(2, 1fr);
            gap: 12px; padding: 12px;
        }

        .card {
            background: var(--card); border-radius: 16px;
            overflow: hidden; position: relative;
            display: flex; flex-direction: column;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .card img { width: 100%; aspect-ratio: 1/1; object-fit: cover; cursor: pointer; }
        
        .photo-badge {
            position: absolute; top: 8px; right: 8px;
            background: rgba(0,0,0,0.7); color: white;
            padding: 2px 6px; border-radius: 6px; font-size: 10px;
        }

        .card-info { padding: 10px; flex-grow: 1; }
        .card h4 { margin: 0; font-size: 14px; height: 34px; overflow: hidden; }
        .price { color: var(--accent); font-weight: bold; margin: 5px 0; }
        
        .buy-btn {
            background: var(--accent); color: #000; border: none;
            padding: 10px; border-radius: 10px; font-weight: bold;
            width: 100%; cursor: pointer;
        }

        /* Gallery Modal */
        #gallery-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 1000; flex-direction: column; align-items: center; justify-content: center;
        }
        #gallery-img { max-width: 100%; max-height: 80vh; object-fit: contain; }
        .nav-btns { position: absolute; width: 100%; display: flex; justify-content: space-between; padding: 0 20px; box-sizing: border-box; }
        .nav-btn { background: rgba(255,255,255,0.2); color: white; border: none; font-size: 30px; padding: 15px; border-radius: 50%; }
        .close-gallery { position: absolute; top: 30px; right: 20px; color: white; font-size: 30px; background: none; border: none; }

        /* Admin Panel */
        #admin-panel { display: none; padding: 15px; background: var(--card); margin: 10px; border-radius: 15px; }
        input, textarea {
            width: 100%; background: var(--bg); border: 1px solid var(--gray);
            color: white; padding: 10px; margin-bottom: 10px; border-radius: 8px; box-sizing: border-box;
        }
        .admin-toggle {
            position: fixed; bottom: 20px; right: 20px; background: #3b82f6;
            color: white; border: none; width: 50px; height: 50px; border-radius: 50%;
            display: none; z-index: 100; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>

    <header>
        <h1 id="main-title">IT Professional Shop</h1>
    </header>

    <div id="banner-box">
        <div class="banner" id="banner-img">
            <div class="banner-text" id="banner-text"></div>
        </div>
    </div>

    <div id="admin-panel">
        <h3>–ê–¥–º–∏–Ω: –ò–ª–æ–≤–∞–∏ –º–∞“≥—Å—É–ª–æ—Ç</h3>
        <input type="text" id="p-name" placeholder="–ù–æ–º–∏ –º–∞“≥—Å—É–ª–æ—Ç">
        <input type="text" id="p-price" placeholder="–ù–∞—Ä—Ö">
        <textarea id="p-imgs" placeholder="–õ–∏–Ω–∫“≥–æ–∏ –∞–∫—Å“≥–æ—Ä–æ –±–æ –≤–µ—Ä–≥—É–ª (,) “∑—É–¥–æ –∫—É–Ω–µ–¥ (—Ç–æ 10 –∞–∫—Å)"></textarea>
        <button class="buy-btn" onclick="saveProduct()">–ó–∞—Ö–∏—Ä–∞ –∫–∞—Ä–¥–∞–Ω</button>
        <hr>
        <h3>–ê–¥–º–∏–Ω: –†–µ–∫–ª–∞–º–∞ (Banner)</h3>
        <input type="text" id="ad-img" placeholder="–õ–∏–Ω–∫–∏ –∞–∫—Å–∏ —Ä–µ–∫–ª–∞–º–∞">
        <input type="text" id="ad-text" placeholder="–ú–∞—Ç–Ω–∏ —Ä–µ–∫–ª–∞–º–∞">
        <button class="buy-btn" style="background:#3b82f6; color:white;" onclick="saveAd()">–ù–∞–º–æ–∏—à–∏ –†–µ–∫–ª–∞–º–∞</button>
        <button class="buy-btn" style="background:red; color:white; margin-top:5px;" onclick="clearData()">–¢–æ–∑–∞ –∫–∞—Ä–¥–∞–Ω–∏ “≥–∞–º–∞</button>
    </div>

    <div class="products" id="product-list"></div>

    <div id="gallery-modal">
        <button class="close-gallery" onclick="closeGallery()">‚úï</button>
        <img id="gallery-img" src="">
        <div class="nav-btns">
            <button class="nav-btn" onclick="changePhoto(-1)">‚ùÆ</button>
            <button class="nav-btn" onclick="changePhoto(1)">‚ùØ</button>
        </div>
        <p id="photo-index" style="color:white; margin-top:10px;"></p>
    </div>

    <button class="admin-toggle" id="admin-btn" onclick="toggleAdmin()">‚öôÔ∏è</button>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const ADMIN_ID = 8406121228; // ID-–∏ —à—É–º–æ
        const ADMIN_USER = "ismoilmurodov21"; // –Æ–∑–µ—Ä–Ω–µ–π–º–∏ —à—É–º–æ

        let currentPhotos = [];
        let currentIndex = 0;

        if (tg.initDataUnsafe?.user?.id === ADMIN_ID) {
            document.getElementById('admin-btn').style.display = 'block';
        }

        function toggleAdmin() {
            const p = document.getElementById('admin-panel');
            p.style.display = p.style.display === 'block' ? 'none' : 'block';
        }

        function saveProduct() {
            const name = document.getElementById('p-name').value;
            const price = document.getElementById('p-price').value;
            const imgsInput = document.getElementById('p-imgs').value;
            const imgsArray = imgsInput.split(',').map(s => s.trim()).filter(s => s !== "");

            if (!name || imgsArray.length === 0) return alert("–ù–æ–º –≤–∞ –∞–∫—Å—Ä–æ –≤–æ—Ä–∏–¥ –∫—É–Ω–µ–¥!");

            let products = JSON.parse(localStorage.getItem('it_products') || '[]');
            products.push({ name, price, photos: imgsArray });
            localStorage.setItem('it_products', JSON.stringify(products));
            
            alert("–ú–∞“≥—Å—É–ª–æ—Ç –∏–ª–æ–≤–∞ —à—É–¥!");
            location.reload();
        }

        function saveAd() {
            const img = document.getElementById('ad-img').value;
            const text = document.getElementById('ad-text').value;
            localStorage.setItem('it_ad', JSON.stringify({ img, text }));
            location.reload();
        }

        function clearData() {
            if(confirm("“≤–∞–º–∞–∏ –º–∞“≥—Å—É–ª–æ—Ç“≥–æ –Ω–µ—Å—Ç –∫–∞—Ä–¥–∞ —à–∞–≤–∞–Ω–¥?")) {
                localStorage.clear();
                location.reload();
            }
        }

        function openGallery(photos) {
            currentPhotos = photos;
            currentIndex = 0;
            showPhoto();
            document.getElementById('gallery-modal').style.display = 'flex';
        }

        function showPhoto() {
            document.getElementById('gallery-img').src = currentPhotos[currentIndex];
            document.getElementById('photo-index').innerText = `${currentIndex + 1} / ${currentPhotos.length}`;
        }

        function changePhoto(dir) {
            currentIndex += dir;
            if (currentIndex < 0) currentIndex = currentPhotos.length - 1;
            if (currentIndex >= currentPhotos.length) currentIndex = 0;
            showPhoto();
        }

        function closeGallery() {
            document.getElementById('gallery-modal').style.display = 'none';
        }

        function buy(name) {
            const msg = encodeURIComponent(`–°–∞–ª–æ–º! –ú–∞–Ω –º–µ—Ö–æ“≥–∞–º –∏–Ω—Ä–æ —Ö–∞—Ä–∞–º: ${name}`);
            tg.openTelegramLink(`https://t.me/${ADMIN_USER}?text=${msg}`);
        }

        function render() {
            const ad = JSON.parse(localStorage.getItem('it_ad') || 'null');
            if (ad && ad.img) {
                document.getElementById('banner-box').style.display = 'block';
                document.getElementById('banner-img').style.backgroundImage = `url(${ad.img})`;
                document.getElementById('banner-text').innerText = ad.text;
            }

            const list = document.getElementById('product-list');
            const products = JSON.parse(localStorage.getItem('it_products') || '[]');
            
            if (products.length === 0) {
                list.innerHTML = `<p style="grid-column: 1/3; text-align:center; color:gray; margin-top:20px;">–ú–∞“≥—Å—É–ª–æ—Ç –Ω–µ—Å—Ç. –ê–∑ –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω –∏–ª–æ–≤–∞ –∫—É–Ω–µ–¥.</p>`;
            }

            products.forEach(p => {
                list.innerHTML += `
                    <div class="card">
                        ${p.photos.length > 1 ? `<div class="photo-badge">üì∏ ${p.photos.length}</div>` : ''}
                        <img src="${p.photos[0]}" onclick='openGallery(${JSON.stringify(p.photos)})' loading="lazy">
                        <div class="card-info">
                            <h4>${p.name}</h4>
                            <div class="price">${p.price}</div>
                            <button class="buy-btn" onclick="buy('${p.name}')">–•–∞—Ä–∏–¥–∞–Ω</button>
                        </div>
                    </div>
                `;
            });
        }

        render();
    </script>
</body>
</html>
